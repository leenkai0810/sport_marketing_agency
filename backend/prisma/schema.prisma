// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

enum Role {
  USER
  EDITOR
  ADMIN
}

enum SubscriptionStatus {
  INACTIVE
  ACTIVE
  CANCELED
}

enum VideoStatus {
  PENDING
  EDITING
  READY
  PUBLISHED
  REJECTED
}

model User {
  id                 String             @id @default(uuid())
  email              String             @unique
  password           String
  name               String?
  phone              String?
  sport              String?
  instagram          String?
  tiktok             String?
  role               Role               @default(USER)
  subscriptionStatus SubscriptionStatus @default(INACTIVE)
  plan               String             @default("none") // none, starter, pro, elite
  contractAccepted   Boolean            @default(false)
  contractAcceptedAt DateTime?
  createdAt          DateTime           @default(now())
  updatedAt          DateTime           @updatedAt

  videos        Video[]        @relation("UserVideos")
  editedVideos  Video[]        @relation("EditedVideos")
  subscriptions Subscription[]
}

model Video {
  id          String      @id @default(uuid())
  caption     String?
  platform    String // Instagram, TikTok, Facebook
  url         String // Original file path or Cloud URL
  editedUrl   String? // Edited version uploaded by editor
  editorNotes String? // Notes from editor
  status      VideoStatus @default(PENDING)
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  userId   String
  user     User   @relation("UserVideos", fields: [userId], references: [id])
  editorId String?
  editor   User?  @relation("EditedVideos", fields: [editorId], references: [id])
}

model Subscription {
  id               String             @id @default(uuid())
  stripeId         String             @unique
  status           SubscriptionStatus
  currentPeriodEnd DateTime
  createdAt        DateTime           @default(now())
  updatedAt        DateTime           @updatedAt

  userId String
  user   User   @relation(fields: [userId], references: [id])
}
